---
title: 云湖群管理bot(指令版)
date: 2025-01-30 21:49:48+08:00
lastMod: 2025-01-31 20:30:34+08:00
summary: This blog post introduces a Python bot for managing Yunhu (云湖) social app groups.  Unlike the cumbersome official methods, this bot streamlines tasks like banning, unbanning, kicking members, deleting messages, and managing temporary administrators via simple commands (!ban, !unban, !kick, !delmsg, !addadmin, !deladmin).  The bot's source code, while encrypted using PyArmor, is publicly available on GitHub and designed to store data securely on a user's own MySQL server, preventing third-party access.  The post provides detailed instructions for installation (using `pip install -r requirements.txt`), configuration (setting environment variables like TOKEN and MYSQL credentials), and deployment.  It also explains how to obtain necessary tokens and includes troubleshooting tips.  The bot offers a significantly improved user experience for group management within the Yunhu app.
tags: []
sticky: 0
---

*这是什么？这是[云湖社交App](https://www.yhchat.com/)群管理指令操作的bot，相比较于官方提供的方式（撤回、禁言等操作麻烦至极，此bot一条命令即可解决*

命令示例：

```
#### 命令帮助
* !ban | 禁言
> !ban @用户 时间（禁言时长只能是 10、1h、6h、12h
* !unban | 取消禁言
> !unban @用户（对用户取消禁言
* !kick | 将用户移出群聊
> !kick @用户
* !delmsg | 删除用户消息
> !delmsg (并引用需要撤回的消息
> !delmsg @用户 需要撤回的条数(最大400条
* !addadmin | 添加临时管理员
> !addadmin @用户
* !deladmin | 删除临时管理员
> !deladmin @用户
* !adminlist | 查看临时管理员列表
```

下载链接：https://github.com/butlanys/YunhuManagebots/

~~源代码已加密，虽然是加密的，但保证是安全的，数据只会存储到你自己的MySQL服务器，并不会上传到第三方，也不会危害宿主机安全（如果仍不放心，欢迎使用docker部署使用）~~

源码已上传，git clone即可食用

**下载后解压得到**

```tree
.
├── app.py
└── pyarmor_runtime_000000
    ├── __init__.py
    └── pyarmor_runtime.so
```

首先运行 `pip install -r requirements.txt`

安装好依赖后，编辑 `.env`文件

```config
TOKEN=
ADMIN_TOKEN=
MYSQL_HOST=
MYSQL_DATABASE=
MYSQL_USER=
MYSQL_PASSWORD=
```

token可在[控制台](https://www.yhchat.com/control)创建bot后得到

admin_token可运行下面命令得到，bash和cmd二选一

```bash
curl 'https://chat-go.jwzhd.com/v1/user/email-login' \
  -H 'Accept: */*' \
  -H 'Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6' \
  -H 'Connection: keep-alive' \
  -H 'Origin: https://chat.yhchat.com' \
  -H 'Referer: https://chat.yhchat.com/' \
  -H 'Sec-Fetch-Dest: empty' \
  -H 'Sec-Fetch-Mode: cors' \
  -H 'Sec-Fetch-Site: cross-site' \
  -H 'User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.0.0 Safari/537.36 Edg/126.0.0.0' \
  -H 'content-type: application/json' \
  -H 'sec-ch-ua: "Not/A)Brand";v="8", "Chromium";v="126", "Microsoft Edge";v="126"' \
  -H 'sec-ch-ua-mobile: ?0' \
  -H 'sec-ch-ua-platform: "Windows"' \
  -H 'token;' \
  --data-raw '{"email":"邮箱","password":"密码","deviceId":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.0.0 Safari/537.36 Edg/126.0.0.0","platform":"Web"}'
```

```cmd
curl "https://chat-go.jwzhd.com/v1/user/email-login" ^
-H "Accept: */*" ^
-H "Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6" ^
-H "Connection: keep-alive" ^
-H "Origin: https://chat.yhchat.com" ^
-H "Referer: https://chat.yhchat.com/" ^
-H "Sec-Fetch-Dest: empty" ^
-H "Sec-Fetch-Mode: cors" ^
-H "Sec-Fetch-Site: cross-site" ^
-H "User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.0.0 Safari/537.36 Edg/126.0.0.0" ^
-H "content-type: application/json" ^
-H ^"sec-ch-ua: ^\^"Not/A)Brand^\^";v=^\^"8^\^", ^\^"Chromium^\^";v=^\^"126^\^", ^\^"Microsoft Edge^\^";v=^\^"126^\^"^" ^
-H "sec-ch-ua-mobile: ?0" ^
-H ^"sec-ch-ua-platform: ^\^"Windows^\^"^" ^
-H "token;" ^
--data-raw ^"^{^\^"email^\^":^\^"邮箱^\^",^\^"password^\^":^\^"密码^\^",^\^"deviceId^\^":^\^"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.0.0 Safari/537.36 Edg/126.0.0.0^\^",^\^"platform^\^":^\^"Web^\^"^}^"
```

剩下的可在创建数据库时得到

然后，运行app.py文件

```bash
python app.py <host>:<port>
```

回到云湖控制台里填写这台机子的IP+刚才设置的端口+`yhchat`路径

例如 `https://you_server.com:8080/yhchat`

接着在群聊中发送!help命令，如果bot有回应则大功告成，你可以愉快的使用此bot了
