---
title: dockerå®‰è£…adguard home (macvlanç‹¬äº«ip)
date: 2024-08-07 10:23:28+08:00
lastMod: 2025-01-27 19:38:26+08:00
summary: æœ¬æ•™ç¨‹ä»‹ç»å¦‚ä½•åœ¨è½¯è·¯ç”±æˆ–æ”¯æŒDockerçš„è®¾å¤‡ä¸Šï¼Œåˆ©ç”¨Macvlanç½‘ç»œæ¨¡å¼éƒ¨ç½²AdGuardHomeå¹¿å‘Šæ‹¦æˆªå™¨ï¼Œé¿å…ä¼ ç»ŸBridgeæ¨¡å¼å¸¦æ¥çš„ç«¯å£å†²çªé—®é¢˜ã€‚æ•™ç¨‹æ¨èä½¿ç”¨1Panelç®€åŒ–Dockerå®¹å™¨ç®¡ç†ã€‚Â Â é¦–å…ˆï¼Œæ•™ç¨‹æŒ‡å¯¼å®‰è£…Dockerå’ŒDockerÂ Composeï¼ˆæˆ–ç›´æ¥ä½¿ç”¨1Panelï¼‰ã€‚Â Â æ ¸å¿ƒæ­¥éª¤æ˜¯é€šè¿‡1Panelåˆ›å»ºä¸€ä¸ªMacvlanç½‘ç»œï¼Œå¹¶åŸºäºæ­¤ç½‘ç»œéƒ¨ç½²AdGuardHomeå®¹å™¨ï¼Œé…ç½®å…¶IPåœ°å€åŠæŒ‚è½½ç›®å½•ã€‚Â Â æ•™ç¨‹ç‰¹åˆ«å¼ºè°ƒé€‰æ‹©åˆé€‚çš„ã€å®‰å…¨çš„DNSä¸Šæ¸¸æœåŠ¡å™¨ï¼Œå¹¶æä¾›äº†è§£å†³å®¹å™¨æ— æ³•è®¿é—®åŠå…¶ä»–æ½œåœ¨é—®é¢˜çš„æ’é”™æ–¹æ³•ï¼ŒåŒ…æ‹¬å¯ç”¨ç½‘å¡æ··æ‚æ¨¡å¼å’Œåˆ›å»ºè¾…åŠ©å®¹å™¨ã€‚Â Â æœ€ç»ˆï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡å®¹å™¨çš„IPåœ°å€è®¿é—®AdGuardHomeçš„ç®¡ç†ç•Œé¢ï¼Œå®ç°å…¨ç½‘å¹¿å‘Šæ‹¦æˆªã€‚
category: docker
tags:
- docker
- adguard home
- macvlan
sticky: 0
---

# å‰è¨€

**æ­¤æ•™ç¨‹é€‚ç”¨äºå®¶é‡Œæœ‰å°é—²ç½®çš„ã€å¯ä»¥é•¿æœŸå¼€æœºçš„è½¯è·¯ç”±æˆ–æ”¯æŒå®‰è£…dockerçš„ç³»ç»Ÿä½¿ç”¨ï¼Œç›®å‰ä¸»æµçš„æ•™ç¨‹éƒ½æ˜¯bridgeç«¯å£æ˜ å°„ï¼Œä½†è¿™ç§ç½‘ç»œæ¨¡å¼å±€é™æ€§éå¸¸å¤§ï¼ˆéœ€å ç”¨53ã€67â€¦â€¦â€¦â€¦ç­‰ä¸€ç³»åˆ—é‡è¦çš„ç«¯å£ï¼‰ï¼Œæ‰€ä»¥æ‰æœ‰ç°åœ¨è¿™ç¯‡æ•™ç¨‹**

# å®‰è£…docker

å¦‚æœé€‰æ‹©1panelæ¥ç®¡ç†å®¹å™¨åˆ™ä¸éœ€è¦è¿™ä¸€æ­¥ï¼ˆæ¨èï¼‰

*å›½é™…*

```bash
curl -fsSL https://get.docker.com -o get-docker.sh
sh get-docker.sh
```

*å›½å†…ï¼ˆè¿™é‡Œä»¥æ¸…åæºä¸ºä¾‹ï¼‰*

```bash
export DOWNLOAD_URL="https://mirrors.tuna.tsinghua.edu.cn/docker-ce"
# å¦‚æ‚¨ä½¿ç”¨ curl
curl -fsSL https://get.docker.com/ | sh
# å¦‚æ‚¨ä½¿ç”¨ wget
wget -O- https://get.docker.com/ | sh
```

*æ£€æŸ¥æ˜¯å¦å®‰è£…æˆåŠŸ*

```
docker version
```

# å®‰è£…docker-compose

å¦‚æœé€‰æ‹©1panelæ¥ç®¡ç†å®¹å™¨åˆ™ä¸éœ€è¦è¿™ä¸€æ­¥ï¼ˆæ¨èï¼‰

```bash
curl -L "https://github.com/docker/compose/releases/download/v2.29.1/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
```

```bash
chmod +x /usr/local/bin/docker-compose
```

```bash
ln -s /usr/local/bin/docker-compose /usr/bin/docker-compose
```

*æ£€æŸ¥æ˜¯å¦å®‰è£…æˆåŠŸ*

```
docker-compose version
```

## å®‰è£…1panelï¼ˆæ¨èï¼‰

[åœ¨çº¿å®‰è£… - 1Panel æ–‡æ¡£](https://1panel.cn/docs/installation/online_installation/)

## æ›´æ¢dockeré•œåƒæº

[é…ç½® - 1Panel æ–‡æ¡£](https://1panel.cn/docs/user_manual/containers/setting/)

è¿™é‡Œæ¨è`https://docker.1panel.live`

## åˆ›å»ºç½‘ç»œé…ç½®

ç™»å½•1panelâ€”â€”å®¹å™¨â€”â€”ç½‘ç»œâ€”â€”åˆ›å»ºç½‘ç»œ
åç§°è‡ªå®šï¼Œç½‘ç»œæ¨¡å¼é€‰**macvlan**
å‰©ä¸‹é…ç½®æŒ‰ä½ å®¶å®é™…ç½‘ç»œç¯å¢ƒå¡«

## åˆ›å»ºå®¹å™¨

åç§°ï¼šadguardhome
é•œåƒï¼ˆæ‰‹åŠ¨è¾“å…¥ï¼‰ï¼šadguard/adguardhome
ç«¯å£ï¼šæš´éœ²æ‰€æœ‰
ç½‘ç»œï¼šé€‰æ‹©åˆšæ‰åˆ›å»ºçš„**macvlan**ç½‘ç»œæ—¶å¡«çš„åå­—
ipv4ï¼šä½ å®¶çš„å±€åŸŸç½‘ç©ºé—²çš„IPï¼Œè¿™é‡Œæˆ‘å¡«äº†192.168.3.254
æŒ‚è½½ï¼š

![https://github.hqycloud.top/https://raw.githubusercontent.com/hqycloud/blog-images/main/hexo-images/24/8/image_893d93e970aac846f0f658d603657bbc.png](https://github.hqycloud.top/https://raw.githubusercontent.com/hqycloud/blog-images/main/hexo-images/24/8/image_893d93e970aac846f0f658d603657bbc.png)
`/opt/adguardhome/conf` `/opt/adguardhome/work`

*æ²¡æåˆ°çš„ä¸è¦å¡«*

å¡«å®Œåç‚¹ç¡®è®¤ï¼Œç­‰å¾…1panelå“åº”åè®¿é—®`å®¹å™¨IP:3000`å³å¯è¿›å…¥å®‰è£…é¡µ

## æ’éšœ

å®¹å™¨å¯åŠ¨åä»ç„¶æ— æ³•è®¿é—®
æ‰“å¼€ç½‘å¡æ··æ‚æ¨¡å¼

```bash
ip link set <ä¸»ç½‘å¡åç§°> promisc on
```

å¦‚æœè¿˜æ˜¯ä¸è¡Œ

å¯ä»¥å»ºä¸€ä¸ªä½¿ç”¨ç›¸åŒç½‘ç»œçš„å®¹å™¨ï¼ˆå¥‡å¥‡æ€ªæ€ªçš„bugç”¨å¥‡å¥‡æ€ªæ€ªçš„æ–¹æ³•è§£å†³ğŸ˜“ ï¼‰

![https://github.hqycloud.top/https://raw.githubusercontent.com/hqycloud/blog-images/main/hexo-images/24/8/image_9c7bdd7ab8df7f28d650105291a45283.png](https://github.hqycloud.top/https://raw.githubusercontent.com/hqycloud/blog-images/main/hexo-images/24/8/image_9c7bdd7ab8df7f28d650105291a45283.png)

è¿™ä¸ªå®¹å™¨ä¸éœ€è¦è·‘ä»»ä½•ä¸œè¥¿ï¼Œè®©å®ƒä¿æŒå¼€ç€å°±è¡Œï¼Œæ‰€ä»¥1panelåˆ›å»ºè¯¥å®¹å™¨æ—¶å¯ä»¥é€‰alpineå®¹å™¨Entrypointé¡¹é‡Œå¡«

```
'sleep' 'infinity'
```

## æ¨èçš„ä¸Šæ¸¸DNS

https://dns.alidns.com/dns-query
https://cloudflare-dns.com/dns-query

* ä¸è¦ä½¿ç”¨æ— ä»»ä½•åŠ å¯†çš„dnsï¼Œä¾‹å¦‚ç›´æ¥ä½¿ç”¨8.8.8.8ï¼ˆä¸­å›½å¤§é™†ä¼šæDNSåŠ«æŒï¼Œä¾‹å¦‚è¿è¥å•†DNSè§£æraw.githubusercontent.comå°±ä¼šè¿”å›0.0.0.0ğŸ˜“ ï¼‰
